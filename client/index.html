<!--<script src="socket.io.js"></script>
<script>
  var s = io.connect('http://192.168.88.241:81');
  
	s.emit('nickname', 'p1mp1$');
  
/*  s.on('message', function (data) {
    console.log(data);
    s.emit('nickname', { param: 'parameters' });
  });*/
</script>-->

<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>BackNode Chat v0.1337</title>
		<script type="text/javascript" src="socket.io.js"></script>
		<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>


	</head>
	<body style="margin: 0; padding: 0;">

<script>
	var s = io.connect('http://192.168.88.241:81');
	
	/*
		PINGING
	*/
	s.on('ping', function (data) {
		console.log('ping received: ' + data + '; ponged back');
		s.emit('pong', data);
		conlog('Ping? Pong!');
	});
	
	/*
		DISCONNECTED
	*/
	s.on('disconnect' , function (data) {
		console.log('Disconnected by server :( (' + data + ')');
		conlog('Disconnected by server! (' + data + ')');
	});
	
	/*
		GLOBAL INFO
	*/
	s.on('info' , function (data) {
		console.log('Info: ' + data);
		conlog(data);
	});
	
	/*
		MOVED
	*/
	s.on('move' , function (data) {
		console.log('Moved: ', data);
	});
	
	/*
		SAYGLOBAL INFO
	*/
	s.on('say' , function (data) {
		console.log('Say; ', data);
		conlog(data.name + ' says: ' + data.message);
	});

	/*function ping()
	{
		console.log("pinging server...");
		var time = new Date();
		//window.alert(time.getTime());
		s.emit('ping', time.getTime());
	}
	setInterval("ping();", 3000);*/

s.on('positions', function (data) {
console.log(data);
//s.emit('nickname', { param: 'parameters' });
});

function conlog(msg)
{
	$('messages').innerHTML = msg + '<br>' + $('messages').innerHTML;
}

function $(id)
{
	return document.getElementById(id);
}

function connect()
{
	s.emit('nickname', $('nickname').value);
	$('splash').style.display = 'none';
	$('console').style.display = 'block';
	$('field').style.display = 'block';
}

document.onkeyup = function(e)
{
	e = e || window.event;
	
	switch (e.keyCode)
	{
		case 38:
			s.emit('move', 'up');
		break;
		
		case 40:
			s.emit('move', 'down');
		break;
		
		case 37:
			s.emit('move', 'left');
		break;
		
		case 39:
			s.emit('move', 'right');
		break;
		
		case 27:
			//s.emit('move', 'up');
			window.alert('quitting?');
		break;
	}
}


function update_positions(users) {
	
	for (var i in users) {
		
		var user = users[i];

		var char = $('#' + user.id);

		if (!char.length) {
			$('#field').append('<div class="char" id="' + user.id + '"><span></span><img src="../img/down.gif" /></div>')			
			var char = $('#' + user.id);
		}

		var.css('top', user.y);
		var.css('left', user.x);

	}

}





</script>
		

<style>

body, html {
	font-family: Arial;
}

#console {
	display: none;
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	height: 280px;
}

#field {
	position: absolute;
	top: 280px;
	left: 0;
	right: 0;
	bottom: 0;
	background: url(http://img9.imageshack.us/img9/7047/shrubbase.jpg);
}


.char {
	width: 50px;
	text-align: center;
	display: block;
	height: 46px;
	margin: -12px 0 0 0;
	position: absolute;
	top: 10%;
	left: 10%;
}
.char span {
	display: block;
	background: black;
	border-radius: 3px;
	color: #fff;
	font-size: 11px;
	margin: 0 0 5px 0;
}

</style>

		<div id="splash">
			Enter your name: <input type="text" id="nickname"> <input type="submit" onclick="connect(); return false;" value="Join!">
		</div>
		
		<div id="console">
			<div id="messages" style="margin: 0 0 5px 0; border-bottom: 1px solid #000; overflow-y: auto; height: 250px;"></div>
			<input type="text" id="cmd" value=""> <input type="text" id="param" value=""> <input type="submit" name="submit" value="Send" onclick="s.emit(document.getElementById('cmd').value, document.getElementById('param').value); return false;">
			<div id="messages" style="margin: 0 0 5px 0; border-bottom: 1px solid #000; overflow-y: auto; height: 250px;"></div>
		</div>
	

		<div id="field" style="display: none">
		</div>
		
	</body>
</html>
